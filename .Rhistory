geom_line(group=1) +
coord_flip(xlim = c(1990, 2020))#, breaks=c(1995, 2000, 2005, 2010, 2015))
jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1) + xlim(1990, 2020)
jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1) + lims(x=c(1990, 2020))
jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1) +
coord_cartesian(xlim = c(1990,2020))
jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1) +
#coord_cartesian(xlim = c(1990,2020))
scale_x_continuous(limits=c(1990,2020))
jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1) +
#coord_cartesian(xlim = c(1990,2020))
scale_x_discrete(limits=c(1990,2020))
jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1) +
#coord_cartesian(xlim = c(1990,2020))
#scale_x_discrete(limits=c(1990,2020))
scale_x_continuous(breaks = c(0, 1000, 2000))
nn = jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n))
nn = jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as_date(founded2))
library(lubridate)
nn = jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as_date(founded2))
nn = jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as_date(founded2))
nn = jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n))
nn = jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded = as_date(founded2))
nn = jj %>%
st_drop_geometry() %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2))
nn %>% ggplot(aes(founded2, csum)) +
geom_line(group=1) +
#coord_cartesian(xlim = c(1990,2020))
#scale_x_discrete(limits=c(1990,2020))
scale_x_continuous(breaks = c(0, 1000, 2000))
View(nn)
nn = jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2))
nn = jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2))
nn %>% ggplot(aes(founded2, csum)) +
geom_line(group=1) +
#coord_cartesian(xlim = c(1990,2020))
#scale_x_discrete(limits=c(1990,2020))
scale_x_continuous(breaks = c(0, 1000, 2000))
nn %>% ggplot(aes(founded2, csum)) +
geom_line(group=1) #+
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1, color='tomato') +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1, color='tomato', width=2) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1, color='tomato', lw=2) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(founded2, csum)) +
geom_line(group=1, color='tomato', size=2) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(founded2, csum)) +
geom_bar(group=1, color='tomato', size=2) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(x=founded2, y=csum)) +
#geom_line(group=1, color='tomato', size=2) +
geom_bar(group=1, color='tomato', size=2) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
select(founded2, csum) %>%
ggplot(aes(x=founded2, y=csum)) +
#geom_line(group=1, color='tomato', size=2) +
geom_bar(group=1, color='tomato', size=2) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(x=founded2, y=csum)) +
#geom_line(group=1, color='tomato', size=2) +
geom_col(group=1, color='tomato', size=2) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(x=founded2, y=csum)) +
#geom_line(group=1, color='tomato', size=2) +
geom_col(group=1) +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(x=founded2, y=csum)) +
#geom_line(group=1, color='tomato', size=2) +
geom_col(group=1, fill='seagreen2') +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(x=founded2, y=csum)) +
#geom_line(group=1, color='tomato', size=2) +
geom_col(group=1, fill='seagreen4') +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
# plot cumulative sum of churches built in Moscow in 1990-2020
jj %>%
st_drop_geometry() %>%
filter(as.numeric(founded2) > 1990) %>%
count(founded2) %>%
mutate(csum = cumsum(n)) %>%
mutate(founded2 = as.numeric(founded2)) %>%
ggplot(aes(x=founded2, y=csum)) +
#geom_line(group=1, color='tomato', size=2) +
geom_col(group=1, fill='seagreen4') +
theme_bw() +
labs(x='year', y='total churches built', title='Number of churches constructed')
ggsave('imgs/cumsum.png', dpi=150)
#################################################
#-----------------------------------------------#
#                     EDA                       #
#-----------------------------------------------#
#################################################
# plot building types versus active (functioning)
ggplot(jj) +
geom_bar(aes(x=type_build, fill=status)) +
#scale_fill_brewer(palette = "Purples") +
theme_bw() +
labs(title="Building types versus status", x="Type of Building", y="Count")
# plot building types versus active (functioning)
ggplot(jj) +
geom_bar(aes(x=type_build, fill=status)) +
#scale_fill_brewer(palette = "Purples") +
theme_bw() +
labs(title="Building types versus status", x="Type of Building", y="Count")
ggsave('imgs/build_type.png', dpi=150)
plot(st_geometry(okrug))
ao = okrug %>% filter(ADMIN_LVL=5)
ao = okrug %>% filter(ADMIN_LVL==5)
View(ao)
# plot churches in UVAO
uvao_jj = st_within(jj, ao%>%filter(OSM_ID==-1278703))
# plot churches in UVAO
uvao_jj = st_within(ao%>%filter(OSM_ID==-1278703), jj)
# plot churches in UVAO
uvao_jj = st_filter(jj, ao%>%filter(OSM_ID==-1278703))
ggplot(uvao_jj) + geom_sf()
ggplot(uvao_jj) +
geom_sf() +
geom_sf(data=ao%>%filter(OSM_ID==-1278703))
geom_sf() +
# plot all
# Create a palette that maps factor levels to colors
pal <- colorFactor(c("navy", "red"), domain = c(0, 1))
ggplot() +
geom_sf(data=ao%>%filter(OSM_ID==-1278703))
ggplot() +
geom_sf(data=ao%>%filter(OSM_ID==-1278703)) +
geom_sf(data=uvao_jj) +
# plot all
# Create a palette that maps factor levels to colors
pal <- colorFactor(c("navy", "red"), domain = c(0, 1))
ggplot() +
geom_sf(data=ao%>%filter(OSM_ID==-1278703)) +
geom_sf(data=uvao_jj) +
# plot all
# Create a palette that maps factor levels to colors
pal <- colorFactor(c("navy", "red"), domain = c(0, 1))
ggplot() +
geom_sf(data=ao%>%filter(OSM_ID==-1278703)) +
geom_sf(data=uvao_jj)
uvao = ao%>%filter(OSM_ID==-1278703)
View(uvao)
# split geometry
split = st_cast(uvao,"POLYGON")
plot(split[1,])
uvao = split[1,]
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj)
uvao = ao%>%filter(OSM_ID==-1278703)
# split geometry
split = st_cast(uvao,"POLYGON")
uvao = split[1,]
uvao_jj = st_filter(jj, ao%>%filter(OSM_ID==-1278703))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj)
uvao_jj = st_filter(jj, uvao)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj)
ggplot() +
geom_sf(data=uvao, aes(fill=prog_200)) +
geom_sf(data=uvao_jj)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(fill=prog_200))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(fill=factor(prog_200)))
# convert prog_200 to binary
uvao_jj$prog_200 = as.factor(uvao_jj$prog_200)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(fill=prog_200))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200))
# convert prog_200 to binary
uvao_jj$prog_200 = factor(uvao_jj$prog_200, levels=c('Not in program', 'In program'))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200))
uvao_jj = st_filter(jj, uvao)
# convert prog_200 to binary
uvao_jj$prog_200 = factor(uvao_jj$prog_200, levels=c('Not in program', 'In program'))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200))
uvao_jj = uvao_jj %>%
mutate(prog_200 = as_factor(prog_200, levels=c("Not in program", "In program")))
# convert prog_200 to binary
uvao_jj$prog_200 = as_factor(uvao_jj$prog_200, levels=c("Not in program", "In program"))
# convert prog_200 to binary
uvao_jj$prog_200 = as_factor(uvao_jj$prog_200)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200))
uvao_jj = st_filter(jj, uvao)
# convert prog_200 to binary
uvao_jj$prog_200 = as_factor(uvao_jj$prog_200)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200), size=2)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200), size=2) +
scale_color_manual(pal)
# plot all
# Create a palette that maps factor levels to colors
pal <- colorFactor(c("navy", "red"), domain = c(0, 1))
?colorFactor
library(RColorBrewer)
myColors <- brewer.pal(2, "Spectral")
names(myColors) <- levels(uvao_jj$prog_200)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200), size=2) +
scale_colour_manual(name = "Species Names", values = myColors)
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(values = c("0" = "purple",
"1"="orange"))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200, shape=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(values = c("0" = "blue",
"1"="red"))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(values = c("0" = "blue",
"1"="red"))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(labels = c('not in program', 'in program'), values = c("0" = "blue","1"="red")) +
# plot all
# Create a palette that maps factor levels to colors
pal <- colorFactor(c("navy", "red"), domain = c(0, 1))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(labels = c('not in program', 'in program'), values = c("0" = "blue","1"="red"))
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(labels = c('not in program', 'in program'), values = c("0" = "blue","1"="red")) +
labs(legend='Program 200')
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(labels = c('not in program', 'in program'), values = c("0" = "blue","1"="red")) +
labs(color='Program 200')
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(labels = c('not in program', 'in program'), values = c("0" = "blue","1"="red")) +
labs(color='Program 200') + theme_bw()
# same in leaflet
leaflet(uvao_jj) %>%
addTiles()
library(leaflet)
# same in leaflet
leaflet(uvao_jj) %>%
addTiles()
# same in leaflet
leaflet(uvao_jj) %>%
addTiles() %>%
addCircleMarkers()
leaflet(uvao_jj) %>%
addTiles() %>%
addCircleMarkers(
radius = 5,
color=~pal(prog_200),
stroke=FALSE,
fillOpacity = .5
)
# same in leaflet
pal <- colorFactor(c("navy", "red"), domain = c(0, 1))
leaflet(uvao_jj) %>%
addTiles() %>%
addCircleMarkers(
radius = 5,
color=~pal(prog_200),
stroke=FALSE,
fillOpacity = .5
)
leaflet(uvao_jj) %>%
addTiles() %>%
addCircleMarkers(
popup = church_id,
radius = 5,
color=~pal(prog_200),
stroke=FALSE,
fillOpacity = .5
)
leaflet(uvao_jj) %>%
addTiles() %>%
addCircleMarkers(
label = ~church_id,
radius = 5,
color=~pal(prog_200),
stroke=FALSE,
fillOpacity = .5
)
# only keep active
uvao_jj = uvao_jj %>% filter(status!="non_preserve")
# plot geographic map with locations in UVAO
ggplot() +
geom_sf(data=uvao) +
geom_sf(data=uvao_jj, aes(color=prog_200), size=2) +
#scale_colour_manual(name = "Species Names", values = myColors)
scale_color_manual(labels = c('not in program', 'in program'), values = c("0" = "blue","1"="red")) +
labs(color='Program 200') + theme_bw()
# same in leaflet
pal <- colorFactor(c("navy", "red"), domain = c(0, 1))
leaflet(uvao_jj) %>%
addTiles() %>%
addCircleMarkers(
label = ~church_id,
radius = 5,
color=~pal(prog_200),
stroke=FALSE,
fillOpacity = .5
)
hist(uvao_jj$status)
ggplot(uvao_jj) + geom_bar(x=type_build)
ggplot(uvao_jj) + geom_bar(aes(x=type_build))
leaflet(uvao_jj) %>%
addTiles() %>%
addCircleMarkers(
label = ~church_id,
radius = 5,
color=~pal(prog_200),
stroke=FALSE,
fillOpacity = .5
)
View(uvao_jj)
